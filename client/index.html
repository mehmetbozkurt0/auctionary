<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Auctionary Test AjanÄ±</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        #log { background: #f0f0f0; padding: 10px; border: 1px solid #ccc; height: 300px; overflow-y: scroll; }
        .sent { color: blue; }
        .received { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
<h2>âš¡ Auctionary WebSocket Testi</h2>
<button onclick="sendBid()">ğŸ’° 500 TL Teklif Ver</button>
<button onclick="sendInvalid()">âŒ Bozuk Veri Yolla</button>

<h3>Loglar:</h3>
<div id="log"></div>

<script>
    // WebSocket baÄŸlantÄ±sÄ±nÄ± aÃ§
    const ws = new WebSocket("ws://localhost:8080/ws");

    ws.onopen = function() {
        log("âœ… Sunucuya baÄŸlanÄ±ldÄ±!", "received");
    };

    ws.onmessage = function(event) {
        log("ğŸ“© Sunucudan cevap: " + event.data, "received");
    };

    ws.onclose = function() {
        log("âš ï¸ BaÄŸlantÄ± koptu.", "error");
    };

    ws.onerror = function(err) {
        log("âŒ Hata oluÅŸtu.", "error");
    };

    // TEKLÄ°F GÃ–NDERME FONKSÄ°YONU
    function sendBid() {
        // Backend'deki 'BidPayload' yapÄ±sÄ±na uygun JSON
        const event = {
            type: "bid_placed",
            payload: {
                auction_id: "item101",
                user_id: "user_mehmet",
                amount: 500.0
            }
        };
        ws.send(JSON.stringify(event));
        log("ğŸ“¤ GÃ¶nderildi: " + JSON.stringify(event), "sent");
    }

    function sendInvalid() {
        ws.send("Bu bir JSON deÄŸil, hata vermeli");
        log("ğŸ“¤ HatalÄ± veri gÃ¶nderildi.", "sent");
    }

    function log(msg, className) {
        const div = document.getElementById("log");
        div.innerHTML += `<div class="${className}">${msg}</div>`;
        div.scrollTop = div.scrollHeight;
    }
</script>
</body>
</html>